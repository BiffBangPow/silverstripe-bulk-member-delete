"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}var BulkDelete=function(){function e(){_classCallCheck(this,e),this.actionButton=document.getElementById("bbp-bulkdelete-action"),this.messageDiv=document.getElementById("bbp-bulkdelete-response"),this.security=document.getElementById("bbp-bulkdelete-secID"),this.memberList=document.getElementById("bbp-bulkdelete-members")}return _createClass(e,[{key:"initButtonActions",value:function(){var e=this;this.actionButton.addEventListener("click",function(){e.submitData()})}},{key:"processResponse",value:function(e,t){var n;200!=e.target.status?t.messageDiv.innerHTML("<p>Sorry, there was a problem.  Please try again"):1===(e=JSON.parse(e.target.responseText)).status?(n="<p><br><strong>Deleted "+e.message.deleted+" accounts</strong></p>",0<e.message.invalid.length&&(n+="<p><strong>Invalid addresses:</strong></p><ul>",e.message.invalid.forEach(function(e){n+="<li>"+e+"</li>"}),n+="</ul>"),0<e.message.notfound.length&&(n+="<p><strong>Not found on the system:</strong></p>",e.message.notfound.forEach(function(e){n+="<li>"+e+"</li>"}),n+="</ul>"),n+="<p><br><strong>Please refresh the page to update the member list</strong></p>",t.memberList.value="",t.memberList.classList.remove("changed"),document.getElementById("Form_EditForm").classList.remove("changed"),t.messageDiv.innerHTML=n):t.messageDiv.innerHTML=e.message,t.actionButton.removeAttribute("disabled")}},{key:"processError",value:function(e){e.messageDiv.innerHTML("<p>Sorry, there was a problem.  Please refresh the page and try again.</p>"),e.actionButton.removeAttribute("disabled")}},{key:"submitData",value:function(){var e=this,t=this.actionButton.dataset.url,n=new XMLHttpRequest,r=new FormData,o=this;r.append("members",this.memberList.value),r.append("security",this.security.value),this.actionButton.setAttribute("disabled","disabled"),this.messageDiv.innerHTML="<p>Processing..</p>",n.open("POST",t),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.addEventListener("error",function(){e.processError(o)}),n.addEventListener("load",function(e){o.processResponse(e,o)}),n.send(r)}}]),e}();document.addEventListener("DOMContentLoaded",function(){(new BulkDelete).initButtonActions()});